const s=window.localStorage.getItem("spacebounce");const a='!';const n=[];const i=new Map;const o={1:'Red',2:'Blue'};const e={token:'thr1.AAAAAGP4v6_9NRY1iPgCBg.0itnBV2jT9s',noPlayer:true,maxPlayers:13,roomName:'🤜🏿 Wrangle 𝐒𝐏𝐀𝐂𝐄𝐁𝐎𝐔𝐍𝐂𝐄 v1.0',"public":true,geo:{code:'eg',lat:40,lon:-3}};const r={"default":['[[playerName]] has scored a goal for the [[team]] team'],og:['an own goal from [[playerName]] for the [[team]] team']};const l={touch:{name:null,id:null,team:null},assist:{name:null,id:null},setTouch(e){this.touch.name=e.name;this.touch.team=e.team;this.touch.id=e.id},setAssist(e){this.assist.name=e.name;this.assist.id=e.id},dispose(){this.touch.name=this.touch.id=this.touch.team=this.assist.name=this.assist.id=null}};const u=[{name:'bb',id:2,syntax:/(bb|leave|ggs)/i,admin:false,show:false},{name:'afk',id:3,syntax:/afk/i,admin:false,show:false}];const m=HBInit(e);m.setTeamsLock(true);m.setCustomStadium(s);m.onPlayerChat=(e,t)=>{t=t.trim();if(t.startsWith(a))return execute(e,t)};m.onStadiumChange=(e,t)=>{if(t!=null){m.setCustomStadium(s)}};m.onPlayerJoin=e=>{snapshot(0);updateAdmins()};m.onPlayerTeamChange=(e,t)=>{if(getPlayerAFK(e.id)){m.setPlayerTeam(e.id,0);m.reorderPlayers(i.get(0),true)}else{snapshot(0)}};m.onPlayerLeave=e=>{removePlayerFromAFK(e.id);snapshot(0);updateAdmins()};m.onGameTick=()=>{const t=m.getPlayerList().filter(e=>e.team!=0);const s=m.getDiscProperties(0);for(let e=0;e<t.length;e++){const a=m.getPlayerDiscProperties(t[e].id);if(distance(a,s)<=a.radius+s.radius+2){updateBallProperties(t[e])}}};m.onPlayerBallKick=e=>{updateBallProperties(e)};m.onPositionsReset=()=>{l.dispose()};m.onGameStop=e=>{l.dispose()};m.onTeamGoal=e=>{const t=isOwnGoal(e);const s=t?'🟣':e==1?'🔴':'🔵';const a=m.getScores();m.sendAnnouncement(`${s} ${(t?r.og:r["default"])[0].replace('[[team]]',o[e]).replace('[[playerName]]',l.touch.name)}${t?'':l.assist.id?` with ${l.assist.name}'s assist`:''} [${a.red} - ${a.blue}] ${s}`,null,t?9531647:e==1?16727614:2201331)};function distance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function updateBallProperties(e){if(e.id!=l.touch.id){if(e.team==l.touch.team){l.setAssist(l.touch)}else{l.setAssist({id:null,name:null})}l.setTouch(e)}}function isOwnGoal(e){return l.touch.team!=e}function updateAdmins(){var e=m.getPlayerList();if(e.length==0)return;if(e.find(e=>e.admin)!=null)return;m.setPlayerAdmin(e[0].id,true)}function execute(e,t){const s=getCommandProperties(t);if(!s)return false;if(s.admin&&!e.admin){m.sendAnnouncement('You are not admin',e.id,15631086,null,0);return false}switch(s.id){case 2:m.kickPlayer(e.id,t);break;case 3:if(getPlayerAFK(e.id)){removePlayerFromAFK(e.id)}else{n.push(e.id);m.setPlayerTeam(e.id,0);snapshot(0)}m.sendAnnouncement(`${e.name} ${getPlayerAFK(e.id)?'is now AFK':'has returned'}`,null,16716947);break}return s.show}function removePlayerFromAFK(a){n.forEach((e,t,s)=>{if(e==a){s.splice(t,1)}})}function getPlayerAFK(t){return n.find(e=>e==t)!=null}function getCommandProperties(t){t=t.slice(1);return u.find(e=>t.match(e.syntax)?.[0]==t)}function snapshot(t){const e=m.getPlayerList();const s=e.filter(e=>e.team==t).map(e=>e.id);i.set(t,s)}
